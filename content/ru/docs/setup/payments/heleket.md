
---
title: Heleket
weight: 1
toc_hide: true
hide_summary: true
---

Настройка платежной системы Heleket

> SHM не умеет конвертировать валюты, поэтому в биллинге следует установить все цены для услуг в той валюте какую указываете в `currency`

* Сохраните в [конфиг]({{< ref "/docs/api/config" >}}) SHM следующие данные:
```yaml
{
  "pay_systems": {
    "heleket": {
      "api_key":"API_ключ_для_совершения_выплат",
      "merchant":"uuid_мерчанта",
      "url_return": "URL_на_котрый_может_перейти_после_оплаты/неоплаты",
      "name":"отабражаемое_имя_платежный_системы_(Heleket)",
      "show_for_client":"true"
    }
  }
}
```
### Не обязательные параметры:

- `currency` - Код валюты (По умолчанию `RUB`) [Поддерживаемые коды валют](https://doc.heleket.com/ru/other/reference)
- `network` - Сетевой код блокчейна ( По умолчанию пусто )
- `course_source` - Сервис, из которого берутся обменные курсы для пересчета в счете-фактуре.
    - Доступные значения:
        - `Binance`
        - `BinanceP2P`
        - `Exmo`
        - `Kucoin`
        - `Garantexio`
    - Если не задано, используются обменные курсы `Heleket`.
- `to_currency` - Параметр используется для указания целевой валюты для пересчета суммы счета. При создании счета-фактуры вы указываете сумму и валюту, и API преобразует эту сумму в эквивалентное значение в to_currency.

    - Например, чтобы создать счет на 20 `USD` в `BTC`:
        - amount: 20
        - currency: `USD`
        - to_currency: `BTC`
    - API конвертирует сумму в размере 20 `USD` в ее эквивалент в `BTC` на основе текущего обменного курса, и пользователь будет платить в `BTC`.
    - to_currency всегда должен быть кодом криптовалюты, а не кодом фиатной валюты.
- `lifetime` - Срок действия выставленного счета-фактуры в секундах ( По умолчанию `3600` )
- `min_amount` - Минимальная сумма платежа, ( По умолчанию `100` )

### Пример ссылки для создания платежа:

`https://admin.ВАШ_ДОМЕН/shm/pay_systems/heleket.cgi?action=create&amount=100`

### Протестировать работоспособности платежной системы:

`https://admin.ВАШ_ДОМЕН/shm/pay_systems/heleket.cgi?action=test`

- Успешный ответ:
```yaml
{
    "state": 0,
    "result": []
}
```
- Параметр `merchant` введён неправильно:
```yaml
{
    "message": "Invalid Merchant Uuid."
}
```
- Неверный `api_key`:
```yaml
{
    "message": "Invalid Sign."
}
```

### HTTP уведомления (Webhook):

- Уведомления в SHM приходят по адресу указанное в разделе “Настройки” -> “Конфигурация”  -> `api` -> `url`:
    - Пример:
        - `https://admin.ВАШ_ДОМЕН/shm/pay_systems/heleket.cgi`
- По желанию можно изменить адрес HTTP уведомлений, для этого нужжно добавить параметр `url_callback` в настройки платежной системы.
